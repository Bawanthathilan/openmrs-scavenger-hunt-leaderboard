(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7330:function(e,r,t){Promise.resolve().then(t.bind(t,5459))},5459:function(e,r,t){"use strict";t.d(r,{ScavengerHuntLeaderboard:function(){return p}});var s=t(288),n=t(5192),a=t(9773),o=t(7009);function c(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.m6)((0,a.W)(r))}function d(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card",className:c("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...t})}function l(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:c("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...t})}function i(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:c("leading-none font-semibold",r),...t})}function u(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:c("px-6",r),...t})}let m=(0,t(7940).j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function x(e){let{className:r,variant:t,...n}=e;return(0,s.jsx)("div",{className:c(m({variant:t}),r),...n})}var h=t(7559),f=t(695),g=t(1901);function p(){let[e,r]=(0,n.useState)([]),[t,a]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null);(0,n.useEffect)(()=>{m()},[]);let m=async()=>{try{a(!0);let e=await fetch("https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhbEn4Z2bPFnNkzt1WNe3Xh5I-bEPnntQvRStsiyqTebV7aMd3KNtjKUdHuS_MqCGhDN9tbwTnA56gNi2qlCJZD-caCohejJ_QNXBoCVuZNuh0Cyth_K_9OgPnYfShs8Ryb3O_b4MAeiy6oHn-Iosr6FDXhiB4J8HrI7U985gJnsEw3bOlSrx_uCSMyvESppYX-uzUTxiL8fvh6SLlhJ2OWBwHQnLm7k0NrmpMuml1YoUyLK92gj3NILlL0tF_eGMGBG5wIC42e_7QN1UtD2ID7kgy4WQ&lib=MHakeFYilqMV2Gs2s46ctyABx2wiTu6LV");if(!e.ok)throw Error("Failed to fetch leaderboard data");let t=await e.json(),s=new Map;t.forEach(e=>{let r=s.get(e.openmrsId),t=new Date(e.timestamp).getTime();if(r){let n=new Date(r.timestamp).getTime();t>n&&s.set(e.openmrsId,e)}else s.set(e.openmrsId,e)});let n=Array.from(s.values()).map(e=>({username:e.openmrsId,points:e.score})).sort((e,r)=>r.points-e.points).map((e,r)=>({...e,rank:r+1}));r(n)}catch(e){c(e instanceof Error?e.message:"An error occurred")}finally{a(!1)}},p=e=>{switch(e){case 1:return(0,s.jsx)(h.Z,{className:"h-5 w-5 text-yellow-500"});case 2:return(0,s.jsx)(f.Z,{className:"h-5 w-5 text-gray-400"});case 3:return(0,s.jsx)(g.Z,{className:"h-5 w-5 text-amber-600"});default:return null}},b=e=>{switch(e){case 1:return"default";case 2:return"secondary";default:return"outline"}},v=e=>"https://talk.openmrs.org/user_avatar/talk.openmrs.org/".concat(e,"/96/20415_2.png");return t?(0,s.jsxs)(d,{className:"w-full",children:[(0,s.jsx)(l,{children:(0,s.jsx)(i,{className:"text-2xl font-bold text-center",children:"Scavenger Hunt"})}),(0,s.jsx)(u,{children:(0,s.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):o?(0,s.jsxs)(d,{className:"w-full",children:[(0,s.jsx)(l,{children:(0,s.jsx)(i,{className:"text-2xl font-bold text-center",children:"Scavenger Hunt"})}),(0,s.jsx)(u,{children:(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("p",{className:"text-destructive",children:["Error: ",o]}),(0,s.jsx)("button",{onClick:m,className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:"Retry"})]})})]}):(0,s.jsxs)(d,{className:"w-full",children:[(0,s.jsxs)(l,{children:[(0,s.jsx)(i,{className:"text-3xl font-bold text-center mb-2",children:"Scavenger Hunt"}),(0,s.jsx)("p",{className:"text-muted-foreground text-center",children:"Current Leaderboard"})]}),(0,s.jsxs)(u,{children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 pb-2 border-b font-semibold text-muted-foreground",children:[(0,s.jsx)("div",{children:"Rank"}),(0,s.jsx)("div",{children:"Avatar"}),(0,s.jsx)("div",{children:"Username"}),(0,s.jsx)("div",{className:"text-right",children:"Points"})]}),e.map(e=>(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 py-3 px-2 rounded-lg transition-colors ".concat(e.rank<=3?"bg-muted/50":"hover:bg-muted/30"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x,{variant:b(e.rank),className:"w-8 h-8 rounded-full flex items-center justify-center p-0",children:e.rank}),p(e.rank)]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("img",{src:v(e.username)||"/placeholder.svg",alt:"".concat(e.username,"'s avatar"),className:"w-10 h-10 rounded-full border-2 border-border",onError:r=>{r.currentTarget.src="https://ui-avatars.com/api/?name=".concat(e.username,"&size=96&background=random")}})}),(0,s.jsx)("div",{className:"flex items-center font-medium",children:e.username}),(0,s.jsx)("div",{className:"flex items-center justify-end font-bold text-lg",children:e.points})]},e.username)),0===e.length&&(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No participants yet"})]}),(0,s.jsx)("div",{className:"mt-6 pt-4 border-t text-center",children:(0,s.jsx)("button",{onClick:m,className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80 transition-colors",children:"Refresh Leaderboard"})})]})]})}}},function(e){e.O(0,[489,24,240,744],function(){return e(e.s=7330)}),_N_E=e.O()}]);