(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7330:function(e,r,t){Promise.resolve().then(t.bind(t,5459))},5459:function(e,r,t){"use strict";t.d(r,{ScavengerHuntLeaderboard:function(){return p}});var s=t(288),a=t(5192),n=t(9773),c=t(7009);function d(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,c.m6)((0,n.W)(r))}function o(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card",className:d("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...t})}function l(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:d("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...t})}function i(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:d("leading-none font-semibold",r),...t})}function u(e){let{className:r,...t}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:d("px-6",r),...t})}let m=(0,t(7940).j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function x(e){let{className:r,variant:t,...a}=e;return(0,s.jsx)("div",{className:d(m({variant:t}),r),...a})}var f=t(7559),h=t(695),g=t(1901);function p(){let[e,r]=(0,a.useState)([]),[t,n]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null);(0,a.useEffect)(()=>{m()},[]);let m=async()=>{try{n(!0);let e=await fetch("https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhuLihfabK0dtgTXZlmD9NAwmuVW-axsjHy2U8496cOFCr5qoUm60vdcU3DQfRtUnGQiXJXxlLcNDk2mbj52vuzfaC0CE0c9G1H61dIuhrxVsTxqjEX-BqBIloxST730dU4DemqQnMFQgJ3ll6RP8zMTmRE9mr92D2gGmsHNIy_Ljzk1zIb9lx0CAudV6r_2BnnBGDsVdmjUrh-3qqnH9c8CTwt6yx0yDwOrH0ib0Oe9Ve5clxLHu05hyDO6RFKh6lS2RFAZY-hXX2XvpkJDdMKEgIkdA&lib=MHakeFYilqMV2Gs2s46ctyABx2wiTu6LV");if(!e.ok)throw Error("Failed to fetch leaderboard data");let t=await e.json(),s=new Map;t.forEach(e=>{let r=s.get(e.openmrsId)||0;s.set(e.openmrsId,r+1)});let a=Array.from(s.entries()).map(e=>{let[r,t]=e;return{username:r,points:10*t}}).sort((e,r)=>r.points-e.points).map((e,r)=>({...e,rank:r+1}));r(a)}catch(e){d(e instanceof Error?e.message:"An error occurred")}finally{n(!1)}},p=e=>{switch(e){case 1:return(0,s.jsx)(f.Z,{className:"h-5 w-5 text-yellow-500"});case 2:return(0,s.jsx)(h.Z,{className:"h-5 w-5 text-gray-400"});case 3:return(0,s.jsx)(g.Z,{className:"h-5 w-5 text-amber-600"});default:return null}},b=e=>{switch(e){case 1:return"default";case 2:return"secondary";default:return"outline"}},j=e=>"https://talk.openmrs.org/user_avatar/talk.openmrs.org/".concat(e,"/96/20415_2.png");return t?(0,s.jsxs)(o,{className:"w-full",children:[(0,s.jsx)(l,{children:(0,s.jsx)(i,{className:"text-2xl font-bold text-center",children:"Scavenger Hunt"})}),(0,s.jsx)(u,{children:(0,s.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):c?(0,s.jsxs)(o,{className:"w-full",children:[(0,s.jsx)(l,{children:(0,s.jsx)(i,{className:"text-2xl font-bold text-center",children:"Scavenger Hunt"})}),(0,s.jsx)(u,{children:(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("p",{className:"text-destructive",children:["Error: ",c]}),(0,s.jsx)("button",{onClick:m,className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",children:"Retry"})]})})]}):(0,s.jsxs)(o,{className:"w-full",children:[(0,s.jsxs)(l,{children:[(0,s.jsx)(i,{className:"text-3xl font-bold text-center mb-2",children:"Scavenger Hunt"}),(0,s.jsx)("p",{className:"text-muted-foreground text-center",children:"Current Leaderboard"})]}),(0,s.jsxs)(u,{children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 pb-2 border-b font-semibold text-muted-foreground",children:[(0,s.jsx)("div",{children:"Rank"}),(0,s.jsx)("div",{children:"Avatar"}),(0,s.jsx)("div",{children:"Username"}),(0,s.jsx)("div",{className:"text-right",children:"Points"})]}),e.map(e=>(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 py-3 px-2 rounded-lg transition-colors ".concat(e.rank<=3?"bg-muted/50":"hover:bg-muted/30"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x,{variant:b(e.rank),className:"w-8 h-8 rounded-full flex items-center justify-center p-0",children:e.rank}),p(e.rank)]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("img",{src:j(e.username)||"/placeholder.svg",alt:"".concat(e.username,"'s avatar"),className:"w-10 h-10 rounded-full border-2 border-border",onError:r=>{r.currentTarget.src="https://ui-avatars.com/api/?name=".concat(e.username,"&size=96&background=random")}})}),(0,s.jsx)("div",{className:"flex items-center font-medium",children:e.username}),(0,s.jsx)("div",{className:"flex items-center justify-end font-bold text-lg",children:e.points})]},e.username)),0===e.length&&(0,s.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"No participants yet"})]}),(0,s.jsx)("div",{className:"mt-6 pt-4 border-t text-center",children:(0,s.jsx)("button",{onClick:m,className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80 transition-colors",children:"Refresh Leaderboard"})})]})]})}}},function(e){e.O(0,[489,24,240,744],function(){return e(e.s=7330)}),_N_E=e.O()}]);